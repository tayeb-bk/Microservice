<!-- src/app/components/donation/donation.component.html -->
<div class="donation-container">
  <!-- Header -->
  <header class="page-header">
    <h1>ğŸ’ Gestion des Donations</h1>
    <p class="subtitle">GÃ©rez et suivez toutes vos donations facilement</p>
  </header>

  <!-- Messages d'alerte -->
  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>
  <div *ngIf="errorMessage" class="alert alert-error">
    {{ errorMessage }}
  </div>

  <!-- Formulaire -->
  <div class="form-section">
    <div class="form-header">
      <h2>{{ isEditMode ? 'âœï¸ Modifier une Donation' : 'â• Ajouter une Donation' }}</h2>
      <p class="form-description">{{ isEditMode ? 'Mettez Ã  jour les informations de la donation' : 'Remplissez le formulaire ci-dessous' }}</p>
    </div>

    <form (ngSubmit)="addDonation()" class="donation-form">
      <div class="form-row">
        <div class="form-group">
          <label for="donorName">Nom du Donateur <span class="required">*</span></label>
          <input
            type="text"
            id="donorName"
            placeholder="Ex: Jean Dupont"
            [(ngModel)]="newDonation.donorName"
            name="donorName"
            required
          />
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input
            type="email"
            id="email"
            placeholder="exemple@email.com"
            [(ngModel)]="newDonation.email"
            name="email"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="amount">Montant (â‚¬) <span class="required">*</span></label>
          <input
            type="number"
            id="amount"
            placeholder="0.00"
            [(ngModel)]="newDonation.amount"
            name="amount"
            min="1"
            step="0.01"
            required
          />
        </div>

        <div class="form-group">
          <label for="paymentMethod">MÃ©thode de Paiement</label>
          <select
            id="paymentMethod"
            [(ngModel)]="newDonation.paymentMethod"
            name="paymentMethod"
          >
            <option value="">Choisir une mÃ©thode</option>
            <option value="VISA">ğŸ’³ Visa</option>
            <option value="MASTERCARD">ğŸ’³ Mastercard</option>
            <option value="AMERICAN_EXPRESS">ğŸ’³ American Express</option>
            <option value="PAYPAL">ğŸ’° PayPal</option>
            <option value="D17">ğŸ¦ D17</option>
            <option value="BANK_TRANSFER">ğŸ¦ Virement Bancaire</option>
            <option value="CASH">ğŸ’µ EspÃ¨ces</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="campaign">Campagne</label>
          <input
            type="text"
            id="campaign"
            placeholder="Ex: Campagne Hiver 2025"
            [(ngModel)]="newDonation.campaign"
            name="campaign"
          />
        </div>
      </div>

      <div class="form-group full-width">
        <label for="message">Message (optionnel)</label>
        <textarea
          id="message"
          placeholder="Message du donateur..."
          [(ngModel)]="newDonation.message"
          name="message"
          rows="3"
        ></textarea>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="isLoading">
          {{ isLoading ? 'â³ En cours...' : (isEditMode ? 'âœ… Mettre Ã  jour' : 'âœ… Ajouter') }}
        </button>
        <button *ngIf="isEditMode" type="button" (click)="cancelEdit()" class="btn btn-secondary">
          âŒ Annuler
        </button>
      </div>
    </form>
  </div>

  <!-- Tableau -->
  <div class="table-section">
    <div class="table-header">
      <div>
        <h2>ğŸ“‹ Liste des Donations</h2>
        <p class="table-description">Total: <strong>{{ donations.length }}</strong> donation(s)</p>
      </div>
      <span class="badge-count">{{ donations.length }}</span>
    </div>

    <!-- Chargement -->
    <div *ngIf="isLoading && donations.length === 0" class="loading-state">
      <div class="spinner"></div>
      <p>Chargement des donations...</p>
    </div>

    <!-- Tableau -->
    <div *ngIf="!isLoading || donations.length > 0" class="table-responsive">
      <table class="donations-table">
        <thead>
        <tr>
          <th>ID</th>
          <th>Donateur</th>
          <th>Email</th>
          <th>Montant</th>
          <th>MÃ©thode</th>
          <th>Statut</th>
          <th>Campagne</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let donation of donations" class="table-row">
          <td class="td-id">#{{ donation.id }}</td>
          <td class="td-donor">
            <div class="donor-info">
              <span class="donor-icon">ğŸ‘¤</span>
              <span>{{ donation.donorName }}</span>
            </div>
          </td>
          <td class="td-email">{{ donation.email || 'â€”' }}</td>
          <td class="td-amount">
            <span class="amount-value">{{ donation.amount | currency:'EUR':'symbol':'1.2-2' }}</span>
          </td>
          <td class="td-method">
            <span class="method-badge">{{ donation.paymentMethod || 'â€”' }}</span>
          </td>
          <td class="td-status">
              <span class="status-badge" [ngClass]="'status-' + (donation.donationStatus?.toLowerCase() || 'pending')">
                {{ donation.donationStatus || 'PENDING' }}
              </span>
          </td>
          <td class="td-campaign">{{ donation.campaign || 'â€”' }}</td>
          <td class="td-actions">
            <button
              (click)="editDonation(donation)"
              class="btn-action btn-edit"
              title="Modifier"
            >
              âœï¸
            </button>
            <button
              (click)="deleteDonation(donation.id!)"
              class="btn-action btn-delete"
              title="Supprimer"
            >
              ğŸ—‘ï¸
            </button>
          </td>
        </tr>

        <!-- Ã‰tat vide -->
        <tr *ngIf="donations.length === 0 && !isLoading" class="empty-row">
          <td colspan="8" class="empty-message">
            <div class="empty-state">
              <span class="empty-icon">ğŸ“­</span>
              <p>Aucune donation trouvÃ©e</p>
              <small>Ajoutez votre premiÃ¨re donation ci-dessus</small>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
