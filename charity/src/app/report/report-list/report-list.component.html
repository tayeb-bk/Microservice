<div class="report-list-container">
  <div class="header">
    <h1>Reports</h1>
    <button class="btn btn-primary" (click)="createNewReport()">
      <i class="icon-plus"></i> Create New Report
    </button>
  </div>

  <!-- Filters -->
  <div class="filters">
    <div class="filter-group">
      <label>Filter by Type:</label>
      <select [(ngModel)]="selectedType" (change)="filterByType(selectedType)" class="filter-select">
        <option value="ALL">All Types</option>
        @for (type of reportTypes; track type) {
          <option [value]="type">{{ type }}</option>
        }
      </select>
    </div>

    <div class="filter-group">
      <label>Filter by Status:</label>
      <select [(ngModel)]="selectedStatus" (change)="filterByStatus(selectedStatus)" class="filter-select">
        <option value="ALL">All Statuses</option>
        @for (status of reportStatuses; track status) {
          <option [value]="status">{{ status }}</option>
        }
      </select>
    </div>
  </div>

  <!-- Loading State -->
  @if (loading) {
    <div class="loading">
      <div class="spinner"></div>
      <p>Loading reports...</p>
    </div>
  }

  <!-- Error State -->
  @if (error) {
    <div class="error-message">
      {{ error }}
      <button (click)="loadReports()" class="btn btn-secondary">Retry</button>
    </div>
  }

  <!-- Reports Table -->
  @if (!loading && !error) {
    <div class="reports-table-container">
      <table class="reports-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Type</th>
            <th>Status</th>
            <th>Generated By</th>
            <th>Created Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (report of filteredReports; track report.id) {
            <tr>
              <td>{{ report.id }}</td>
              <td>{{ report.title }}</td>
              <td><span class="badge badge-type">{{ report.type }}</span></td>
              <td><span class="badge" [ngClass]="getStatusClass(report.status)">{{ report.status }}</span></td>
              <td>{{ report.generatedBy }}</td>
              <td>{{ formatDate(report.createdDate) }}</td>
              <td class="actions">
                <button 
                  (click)="viewReport(report.id)" 
                  class="btn btn-sm btn-info" 
                  title="View Details">
                  <i class="icon-eye"></i> View
                </button>
                <button 
                  (click)="editReport(report.id)" 
                  class="btn btn-sm btn-warning" 
                  title="Edit Report">
                  <i class="icon-edit"></i> Edit
                </button>
                <button 
                  (click)="deleteReport(report, $event)" 
                  class="btn btn-sm btn-danger" 
                  title="Delete Report"
                  [disabled]="isDeleting(report.id)"
                  [class.deleting]="isDeleting(report.id)">
                  @if (isDeleting(report.id)) {
                    <span class="btn-spinner"></span> Deleting...
                  } @else {
                    <i class="icon-trash"></i> Delete
                  }
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>

      @if (filteredReports.length === 0) {
        <div class="no-reports">
          <p>No reports found.</p>
          @if (selectedType !== 'ALL' || selectedStatus !== 'ALL') {
            <button (click)="selectedType = 'ALL'; selectedStatus = 'ALL'; applyFilters()" class="btn btn-secondary">
              Clear Filters
            </button>
          }
        </div>
      }
    </div>
  }
</div>