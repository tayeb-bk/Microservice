<div class="report-detail-container">
  <!-- Header -->
  <div class="header">
    <button class="btn btn-secondary" (click)="backToList()">
      <i class="icon-arrow-left"></i> Back to Reports
    </button>
    @if (report) {
      <div class="header-actions">
        <button class="btn btn-warning" (click)="editReport()">
          <i class="icon-edit"></i> Edit
        </button>
        <button class="btn btn-info" (click)="downloadReport()">
          <i class="icon-download"></i> Download PDF
        </button>
        <button class="btn btn-danger" (click)="deleteReport()">
          <i class="icon-trash"></i> Delete
        </button>
      </div>
    }
  </div>

  <!-- Loading State -->
  @if (loading) {
    <div class="loading">
      <div class="spinner"></div>
      <p>Loading report details...</p>
    </div>
  }

  <!-- Error State -->
  @if (error) {
    <div class="error-message">
      {{ error }}
      <button (click)="loadReport()" class="btn btn-secondary">Retry</button>
    </div>
  }

  <!-- Report Details -->
  @if (!loading && !error && report) {
    <div class="report-content">
      <!-- Main Info Card -->
      <div class="info-card">
        <div class="card-header">
          <h1>{{ report.title }}</h1>
          <span class="badge" [ngClass]="getStatusClass(report.status)">
            {{ report.status }}
          </span>
        </div>

        <div class="card-body">
          <div class="info-row">
            <div class="info-item">
              <label>Report ID:</label>
              <span>{{ report.id }}</span>
            </div>
            <div class="info-item">
              <label>Type:</label>
              <span class="badge badge-type">{{ report.type }}</span>
            </div>
          </div>

          <div class="info-row">
            <div class="info-item">
              <label>Generated By:</label>
              <span>{{ report.generatedBy }}</span>
            </div>
            <div class="info-item">
              <label>Created Date:</label>
              <span>{{ formatDate(report.createdDate) }}</span>
            </div>
          </div>

          <div class="info-row">
            <div class="info-item">
              <label>Updated Date:</label>
              <span>{{ formatDate(report.updatedDate) }}</span>
            </div>
            @if (report.filePath) {
              <div class="info-item">
                <label>File Path:</label>
                <span>{{ report.filePath }}</span>
              </div>
            }
          </div>

          @if (report.periodStart && report.periodEnd) {
            <div class="info-row">
              <div class="info-item">
                <label>Period Start:</label>
                <span>{{ formatDate(report.periodStart) }}</span>
              </div>
              <div class="info-item">
                <label>Period End:</label>
                <span>{{ formatDate(report.periodEnd) }}</span>
              </div>
            </div>
          }

          @if (report.description) {
            <div class="description-section">
              <label>Description:</label>
              <p>{{ report.description }}</p>
            </div>
          }
        </div>
      </div>

      <!-- Status Management Card -->
      <div class="status-card">
        <h3>Status Management</h3>
        <p>Update the report status:</p>
        <div class="status-buttons">
          <button 
            class="status-btn btn-pending"
            (click)="updateStatus(ReportStatus.PENDING)"
            [disabled]="report.status === ReportStatus.PENDING">
            Pending
          </button>
          <button 
            class="status-btn btn-in-progress"
            (click)="updateStatus(ReportStatus.IN_PROGRESS)"
            [disabled]="report.status === ReportStatus.IN_PROGRESS">
            In Progress
          </button>
          <button 
            class="status-btn btn-completed"
            (click)="updateStatus(ReportStatus.COMPLETED)"
            [disabled]="report.status === ReportStatus.COMPLETED">
            Completed
          </button>
          <button 
            class="status-btn btn-failed"
            (click)="updateStatus(ReportStatus.FAILED)"
            [disabled]="report.status === ReportStatus.FAILED">
            Failed
          </button>
          <button 
            class="status-btn btn-cancelled"
            (click)="updateStatus(ReportStatus.CANCELLED)"
            [disabled]="report.status === ReportStatus.CANCELLED">
            Cancelled
          </button>
        </div>
      </div>

      <!-- Report Data Section -->
      @if (report.reportData && report.reportData.length > 0) {
        <div class="data-card">
          <h3>Report Data</h3>
          <div class="data-table">
            <table>
              <thead>
                <tr>
                  <th>Key</th>
                  <th>Value</th>
                  <th>Type</th>
                  <th>Order</th>
                </tr>
              </thead>
              <tbody>
                @for (data of report.reportData; track data.dataKey) {
                  <tr>
                    <td><strong>{{ data.dataKey }}</strong></td>
                    <td>{{ data.dataValue }}</td>
                    <td><span class="data-type-badge">{{ data.dataType }}</span></td>
                    <td>{{ data.displayOrder || '-' }}</td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      }
    </div>
  }
</div>